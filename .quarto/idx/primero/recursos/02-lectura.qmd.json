{"title":"**Lectura de un archivo de datos de texto plano**","markdown":{"yaml":{"title":"**Lectura de un archivo de datos de texto plano**","format":{"html":{"page-layout":"full","include-in-header":[{"text":"<link rel=\"icon\" type=\"image/x-icon\" href=\"favicon.ico\">\n"}],"toc":true,"toc-title":"Contenidos","toc-location":"left","toc_float":true,"toc_collapsed":false,"toc_depth":4}},"number_sections":true,"anchor_sections":true},"headingText":"Introducción","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, dpi = 300)\n```\n\n\n\nAnteriormente dijimos que para leer o importar datos de un archivo de datos con texto plano separado por comas vamos a utilizar alguna de las funciones del paquete **readr** del tidyverse.\n\nPero para saber cual es la función adecuada y para adaptar sus argumentos correctamente vamos a necesitar conocer la configuración del archivo de datos.\n\nEn este paso a paso, mostraremos las etapas a ejecutar ante una situación de lectura.\n\nEn primer lugar, es deseable que conozcamos previamente los archivos con los cuales trabajamos, o bien si son archivos de datos que se reciben de alguna fuente externa vengan acompañados de un diccionario de datos con especificaciones técnicas del propio archivo como de sus variables.\n\nUn ejemplo de esto es el detalle técnico de la tabla de datos que figura en el documento usuario de la **Encuesta Nacional de Factores de Riesgo** que vemos debajo:\n\n```{r,echo=F,  fig.align='center', out.width = \"60%\", dpi=300}\nknitr::include_graphics(\"img/02/enfr.PNG\")\n```\n\nEsta información nos dice que el archivo es de texto plano, utiliza como delimitador de columna a la barra vertical, que la primera línea lleva los nombres de las variables y que la codificación (encoding) de los caracteres tiene el estándar UTF-8.\n\nEn función de estos datos podríamos componer nuestra lectura de la siguiente forma:\n\n```{r, eval=F}\nenfr <- read_delim(file = \"ENFR2013_base_usuario.txt\", \n                   delim = \"|\", \n                   locale = locale(encoding = \"UTF-8\"))\n```\n\nAunque es el estándar predeterminado, completamos el argumento del encoding a propósito para mostrar como se vincula cada parte de la función con la información del archivo de datos.\n\nSi no llegasemos a disponer de esta información es muy posible que debamos investigar el archivo que deseamos importar para saber sus características.\n\nEn este documento utilizaremos el archivo **def2022.csv** con las defunciones del año 2022 producido por la DEIS.\n\n## Separador o delimitador de columnas\n\nLa primera cosa que podemos hacer con un archivo de texto plano es abrirlo con un software tipo block de notas o con el mismo RStudio para saber cual es el caracter que utiliza como separador de columnas. \n\nCuando el archivo tiene extensión csv generalmente el separador puede ser coma o punto y coma. Pero recién vimos que la extensión puede ser txt y el separador, alguno de los caracteres habituales (espacio, tabulación, etc).\n\nDesde **RStudio**, cuando se pulsa el botón izquierdo del mouse sobre el archivo de datos que aparece en el panel *Files*, se abre una ventana emergente que nos ofrece la posibilidad de visualizarlo en el editor (*\"View File\"*). Si el archivo es muy pesado (mayor a 5 Mb) RStudio nos avisará que no lo puede hacer porque excede su capacidad, entonces deberemos hacerlo desde un programa similar al **Block de Notas** de Windows que trabaja con texto plano. \n\nVeríamos algo así:\n\n```{r,echo=F,  fig.align='center', out.width = \"90%\", dpi=300}\nknitr::include_graphics(\"img/02/visor.PNG\")\n```\n\nPodemos identificar claramente que el caracter que se repite como delimitador es la coma (,). Si hubiese datos numéricos con decimales, también es importante identificar cual es el separador de decimales (en los casos de delimitadores de columna con coma se utiliza el punto para los decimales).\n\nTambién se puede advertir que la primera línea corresponde a los nombres de las columnas (variables) de nuestra tabla de datos.\n\nCon esta información seleccionaremos como función de lectura a `read_csv()` que tiene estos valores de separadores como predeterminados.\n\n## Encoding\n\nPara conocer cual es la codificación del archivo podemos usar una función del paquete **readr**, llamada `guess_encoding()`.\n\n```{r, message=F, warning=FALSE}\nlibrary(tidyverse)\n\nguess_encoding(\"datos/def2022.csv\")\n```\n\nEl resultado nos informa del estándar ISO-8859-1 con una confianza del 52 %. Existen muchos estandares como posibilidad en el mundo informático, aunque el predeterminado de RStudio es el UTF-8.\n\nA partir de tener esta información podemos configurar el argumento necesario para hacer una lectura correcta de los caracteres especiales que puede tener el archivo.\n\n```{r}\ndef2022 <- read_csv(\"datos/def2022.csv\", \n                 locale = locale(encoding = \"ISO-8859-1\"))\n```\nLa ejecución de la función nos confirma que se realizó usando:\n\n- la coma como delimitador. \n- que se importaron 397115 filas y 28 columnas. \n- detectó 20 variables de tipo character y 8 numéricas (double)\n\nVeamos 10 observaciones para verificar la lectura:\n\n```{r, echo=F, message=F, warning=F}\ndef2022 |> \n  slice(1:10)\n```\n\nHacer coincidir el encoding del archivo con el definido en la lectura hace que los caracteres se importen adecuadamente y no tengamos inconvenientes con caracteres especiales como vocales acentuadas, eñes u otras situaciones.\n\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, dpi = 300)\n```\n\n\n## Introducción\n\nAnteriormente dijimos que para leer o importar datos de un archivo de datos con texto plano separado por comas vamos a utilizar alguna de las funciones del paquete **readr** del tidyverse.\n\nPero para saber cual es la función adecuada y para adaptar sus argumentos correctamente vamos a necesitar conocer la configuración del archivo de datos.\n\nEn este paso a paso, mostraremos las etapas a ejecutar ante una situación de lectura.\n\nEn primer lugar, es deseable que conozcamos previamente los archivos con los cuales trabajamos, o bien si son archivos de datos que se reciben de alguna fuente externa vengan acompañados de un diccionario de datos con especificaciones técnicas del propio archivo como de sus variables.\n\nUn ejemplo de esto es el detalle técnico de la tabla de datos que figura en el documento usuario de la **Encuesta Nacional de Factores de Riesgo** que vemos debajo:\n\n```{r,echo=F,  fig.align='center', out.width = \"60%\", dpi=300}\nknitr::include_graphics(\"img/02/enfr.PNG\")\n```\n\nEsta información nos dice que el archivo es de texto plano, utiliza como delimitador de columna a la barra vertical, que la primera línea lleva los nombres de las variables y que la codificación (encoding) de los caracteres tiene el estándar UTF-8.\n\nEn función de estos datos podríamos componer nuestra lectura de la siguiente forma:\n\n```{r, eval=F}\nenfr <- read_delim(file = \"ENFR2013_base_usuario.txt\", \n                   delim = \"|\", \n                   locale = locale(encoding = \"UTF-8\"))\n```\n\nAunque es el estándar predeterminado, completamos el argumento del encoding a propósito para mostrar como se vincula cada parte de la función con la información del archivo de datos.\n\nSi no llegasemos a disponer de esta información es muy posible que debamos investigar el archivo que deseamos importar para saber sus características.\n\nEn este documento utilizaremos el archivo **def2022.csv** con las defunciones del año 2022 producido por la DEIS.\n\n## Separador o delimitador de columnas\n\nLa primera cosa que podemos hacer con un archivo de texto plano es abrirlo con un software tipo block de notas o con el mismo RStudio para saber cual es el caracter que utiliza como separador de columnas. \n\nCuando el archivo tiene extensión csv generalmente el separador puede ser coma o punto y coma. Pero recién vimos que la extensión puede ser txt y el separador, alguno de los caracteres habituales (espacio, tabulación, etc).\n\nDesde **RStudio**, cuando se pulsa el botón izquierdo del mouse sobre el archivo de datos que aparece en el panel *Files*, se abre una ventana emergente que nos ofrece la posibilidad de visualizarlo en el editor (*\"View File\"*). Si el archivo es muy pesado (mayor a 5 Mb) RStudio nos avisará que no lo puede hacer porque excede su capacidad, entonces deberemos hacerlo desde un programa similar al **Block de Notas** de Windows que trabaja con texto plano. \n\nVeríamos algo así:\n\n```{r,echo=F,  fig.align='center', out.width = \"90%\", dpi=300}\nknitr::include_graphics(\"img/02/visor.PNG\")\n```\n\nPodemos identificar claramente que el caracter que se repite como delimitador es la coma (,). Si hubiese datos numéricos con decimales, también es importante identificar cual es el separador de decimales (en los casos de delimitadores de columna con coma se utiliza el punto para los decimales).\n\nTambién se puede advertir que la primera línea corresponde a los nombres de las columnas (variables) de nuestra tabla de datos.\n\nCon esta información seleccionaremos como función de lectura a `read_csv()` que tiene estos valores de separadores como predeterminados.\n\n## Encoding\n\nPara conocer cual es la codificación del archivo podemos usar una función del paquete **readr**, llamada `guess_encoding()`.\n\n```{r, message=F, warning=FALSE}\nlibrary(tidyverse)\n\nguess_encoding(\"datos/def2022.csv\")\n```\n\nEl resultado nos informa del estándar ISO-8859-1 con una confianza del 52 %. Existen muchos estandares como posibilidad en el mundo informático, aunque el predeterminado de RStudio es el UTF-8.\n\nA partir de tener esta información podemos configurar el argumento necesario para hacer una lectura correcta de los caracteres especiales que puede tener el archivo.\n\n```{r}\ndef2022 <- read_csv(\"datos/def2022.csv\", \n                 locale = locale(encoding = \"ISO-8859-1\"))\n```\nLa ejecución de la función nos confirma que se realizó usando:\n\n- la coma como delimitador. \n- que se importaron 397115 filas y 28 columnas. \n- detectó 20 variables de tipo character y 8 numéricas (double)\n\nVeamos 10 observaciones para verificar la lectura:\n\n```{r, echo=F, message=F, warning=F}\ndef2022 |> \n  slice(1:10)\n```\n\nHacer coincidir el encoding del archivo con el definido en la lectura hace que los caracteres se importen adecuadamente y no tengamos inconvenientes con caracteres especiales como vocales acentuadas, eñes u otras situaciones.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"link-external-filter":"^https:\\/\\/(datos-ine|www)?\\.?(linkedin|twitter|github)\\.*"},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","include-in-header":[{"text":"<link rel=\"icon\" type=\"image/x-icon\" href=\"img/favicon.ico\">\n"},{"text":"<link rel=\"icon\" type=\"image/x-icon\" href=\"favicon.ico\">\n"}],"toc":true,"output-file":"02-lectura.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"Contenido","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.54","theme":{"light":["pulse","../../custom.scss"],"dark":"darkly"},"code-copy":true,"anchor-sections":false,"bibliography":["../../references.bib"],"title":"**Lectura de un archivo de datos de texto plano**","number_sections":true,"anchor_sections":true,"page-layout":"full","toc-title":"Contenidos","toc-location":"left","toc_float":true,"toc_collapsed":false,"toc_depth":4},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}